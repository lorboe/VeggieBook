<h1>Detail</h1>


{{!-- BUTTON TO JOIN THE EVENT --}}
 <form action="/events/{{event._id}}/join" method="POST">
      <button>Join Event</button>
    </form>
<br><br>

{{!-- SEE DETAILS OF THE EVENT --}}
<img src="{{event.imgPath}}" alt="Event's image" height="150px">
{{event.title}} <br>
{{event.date}} <br>
{{event.description}} <br>
{{event.city}} <br>

{{!-- SEE MAP ON THE EVENT PAGE --}}
Location in map:

<div id="map" style="height: 200px"></div>

<script>
var coordinates = [{{event.location.coordinates}}]

// Add your own token
mapboxgl.accessToken = "pk.eyJ1Ijoic2FtNDZoIiwiYSI6ImNqb2l6a3p2dDAzbW4za211cHA5dnRhODkifQ.ZnR13DvzV1nhFr4fqyQOgg"//this is where you add your mapbox key - please note that adding it in the .env file is not sufficient, you'll need to add the key here.

let map = new mapboxgl.Map({
  container: 'map', // Select the div with the id 'map'
  style: 'mapbox://styles/mapbox/streets-v10',
  center: coordinates, // starting position [longitude,latitude]
  zoom: 13 // starting zoom
})

map.addControl(new mapboxgl.NavigationControl())


let eventMarker = new mapboxgl.Marker({
  color: '#222222' // Black
})
  .setLngLat(coordinates)
  .addTo(map)

</script>

 {{#ifEquals currentUserId event._creator}}
{{!-- EDIT EVENTS --}}
 <form action="/events/{{event._id}}/edit" method ="get">
      <button>Edit</button>
 <i class="fas fa-pencil-alt"></i>
    </form>

{{!-- DELETE EVENTS --}}
 <form action="/events/{{event._id}}/delete" method ="get">
      <button>Delete</button>
      <i class="fas fa-trash-alt"></i>
    </form>
 {{/ifEquals}}

{{!-- DISPLAY ALL EVENT COMMENTS --}}
    <h5>Comments:</h5>
    {{#each event.comments}}
      <p>{{this.content}}</p>
      <h6>{{this.creatorUsername}}</h6>

     {{!--ONLY ALLOW LOGGEDIN USER TO DELETE HIS OWN COMMENTS   --}}
      {{#ifEquals ../currentUserId this._creatorId }}
      <form action="/events/{{../event._id}}/comment/{{this._id}}/delete" method="POST">
          <button>Delete comment</button> 
          <i class="fas fa-trash-alt"></i>

        </form>
      {{/ifEquals}}
      {{/each}}

        {{!-- ADD COMMENT --}}
    <form action="/events/{{event._id}}/add-comment" method="POST">
      <textarea name="content" cols="30" row="10"></textarea>
      <button>Add Comment</button>
    </form>

    {{!-- DISPLAY PARTICIPANTS --}}
<h2>List of participants</h2>
<ul>
{{#each participants}}
<li>
  {{this._user.username}}
</li>
{{/each}}
</ul>